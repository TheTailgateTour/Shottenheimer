<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scan for The Shottenheimer Menu â€¢ QR</title>
  <meta name="theme-color" content="#E31837" />
  <style>
    :root{ --card:#171a21; --muted:#b9c2cf; --accent:#E31837; }
    body{display:flex;align-items:center;justify-content:center;min-height:100svh;margin:0;
         background:#0f1216;color:#f7f7f8;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .card{max-width:560px;width:100%;text-align:center;background:var(--card);padding:20px;border-radius:16px;
          border:1px solid rgba(255,255,255,.08)}
    h1{margin:6px 0 6px}
    .sub{color:var(--muted);margin:0 0 6px}
    .url{color:var(--muted);font-size:.95rem;word-break:break-all;margin:2px 0 8px}
    .qr{margin:12px auto 8px;display:inline-block;background:#fff;padding:12px;border-radius:12px}
    .row{display:flex;gap:10px;justify-content:center;margin-top:10px}
    button{background:var(--accent);border:none;color:#fff;font-weight:900;padding:10px 14px;border-radius:10px;cursor:pointer}
    @media print{.row{display:none}body{padding:0}}
  </style>
</head>
<body>
  <main class="card">
    <h1>Scan the QR Code</h1>
    <p class="sub">Opens <strong><a href="index.html" class="inline">The Shottenheimer</a></strong> menu</p>
    <p class="url" id="menuUrl"></p>
    <div id="qrcode" class="qr" aria-label="QR code"></div>
    <div class="row">
      <button id="printBtn">Print</button>
      <button id="downloadBtn">Download PNG</button>
    </div>
  </main>

  <!-- Try CDN first (okay to leave; if blocked, we fallback automatically) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
          integrity="sha512-Mw8CKQ2JrX8o1bXj3k5Qh0V2Gq04cyrbq8WmAyd1H92rQ8Yw0ylkWw+N7pUdU4XMxr2W5fQ20oy3a0C4nU8Y7Q=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    (function () {
      // Optional: hardcode your URL here so it never depends on the page location.
      // If left blank, we derive it from the current URL.
      const HARDCODED_URL = 'https://thetailgatetour.github.io/shottenheimer/';

      function targetUrl() {
        if (HARDCODED_URL) return HARDCODED_URL;
        const href = window.location.href;
        let base = href.replace(/qr(-fixed)?\\.html.*/i, '');
        if (!base.endsWith('/')) base += '/';
        return base;
      }

      const url = targetUrl();
      const host = document.getElementById('qrcode');
      const urlText = document.getElementById('menuUrl');
      urlText.textContent = url;

      // Buttons
      document.getElementById('printBtn').addEventListener('click', () => window.print());

      document.getElementById('downloadBtn').addEventListener('click', () => {
        const canvas = host.querySelector('canvas');
        if (canvas) {
          const a = document.createElement('a');
          a.download = 'shottenheimer-qr.png';
          a.href = canvas.toDataURL('image/png');
          a.click();
          return;
        }
        const img = host.querySelector('img');
        if (img) {
          // Open fallback image in a new tab so it can be saved
          window.open(img.src, '_blank');
          return;
        }
        alert('QR not ready.');
      });
    })();
  </script>
</body>
</html>
